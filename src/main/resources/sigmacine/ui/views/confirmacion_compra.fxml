<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<BorderPane prefWidth="960.0" prefHeight="600.0"
            xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="sigmacine.ui.controller.ConfirmacionCompraController"
            stylesheets="@sigma.css">

    <!-- ===== TOP BAR ===== -->
    <top>
        <fx:include source="barra.fxml"/>
    </top>

    <!-- ===== CENTER ===== -->
    <center>
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" style="-fx-background-color: #000000;" vbarPolicy="AS_NEEDED">
            <content>
                <VBox prefWidth="900.0" style="-fx-padding: 40; -fx-spacing: 25; -fx-background-color: #000000;">
                    <children>

                        <!-- Encabezado de confirmación -->
                        <VBox alignment="CENTER" spacing="10" style="-fx-padding: 20; -fx-background-color: #1a4d2e; -fx-background-radius: 10;">
                            <children>
                                <Label style="-fx-font-size: 36; -fx-text-fill: #4CAF50;" text="✓" />
                                <Label fx:id="lblTituloConfirmacion" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="¡Compra Exitosa!" />
                                <Label fx:id="lblIdCompra" style="-fx-font-size: 14; -fx-text-fill: #cccccc;" text="ID de Compra: #1001" />
                                <Label fx:id="lblFechaCompra" style="-fx-font-size: 12; -fx-text-fill: #aaaaaa;" text="Fecha: 25/11/2025 20:45" />
                            </children>
                        </VBox>

                        <!-- Método de pago -->
                        <VBox style="-fx-spacing: 10; -fx-padding: 20; -fx-background-color: #1a1a1a; -fx-background-radius: 8;">
                            <children>
                                <Label style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="Metodo de Pago" />
                                <Label fx:id="lblMetodoPago" style="-fx-font-size: 14; -fx-text-fill: #4CAF50; -fx-font-weight: bold;" text="Tarjeta de Credito" />
                            </children>
                        </VBox>

                        <!-- Información SigmaCard (visible solo si se pagó con SigmaCard) -->
                        <VBox fx:id="sigmaCardContainer" style="-fx-spacing: 10; -fx-padding: 20; -fx-background-color: #8B2E21; -fx-background-radius: 8;">
                            <children>
                                <Label style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="SigmaCard - Información" />
                                <VBox spacing="5">
                                    <children>
                                        <Label fx:id="lblSaldoAnterior" style="-fx-font-size: 13; -fx-text-fill: #ffffff;" text="Saldo anterior: 0.00" />
                                        <Label fx:id="lblMontoDebitado" style="-fx-font-size: 13; -fx-text-fill: #ffffff;" text="Monto debitado: 0.00" />
                                        <Label fx:id="lblSaldoNuevo" style="-fx-font-size: 13; -fx-text-fill: #4CAF50; -fx-font-weight: bold;" text="Saldo actual: 0.00" />
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- Resumen de compra -->
                        <VBox style="-fx-spacing: 15; -fx-padding: 20; -fx-background-color: #1a1a1a; -fx-background-radius: 8;">
                            <children>
                                <Label style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="Resumen de Compra" />

                                <!-- Contenedor de boletas y productos -->
                                <HBox spacing="20" VBox.vgrow="ALWAYS">
                                    <children>
                                        <!-- Boletas -->
                                        <VBox HBox.hgrow="ALWAYS" spacing="10" style="-fx-background-color: #0a0a0a; -fx-padding: 15; -fx-background-radius: 5;">
                                            <children>
                                                <Label style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #ffffff; -fx-padding: 0 0 5 0;" text="BOLETAS" />
                                                <VBox fx:id="boletasContainer" spacing="10" />
                                            </children>
                                        </VBox>

                                        <!-- Productos -->
                                        <VBox HBox.hgrow="ALWAYS" spacing="10" style="-fx-background-color: #0a0a0a; -fx-padding: 15; -fx-background-radius: 5;">
                                            <children>
                                                <Label style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #ffffff; -fx-padding: 0 0 5 0;" text="CONFITERIA" />
                                                <VBox fx:id="productosContainer" spacing="10" />
                                            </children>
                                        </VBox>
                                    </children>
                                </HBox>

                                <!-- Total -->
                                <HBox alignment="CENTER_RIGHT" spacing="15" style="-fx-padding: 15; -fx-background-color: #8B2E21; -fx-background-radius: 5;">
                                    <children>
                                        <Label style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="TOTAL PAGADO:" />
                                        <Label fx:id="lblTotal" style="-fx-font-size: 22; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="0.00" />
                                    </children>
                                </HBox>
                            </children>
                        </VBox>

                        <!-- Código QR de las boletas -->
                        <VBox fx:id="qrContainer" alignment="CENTER" spacing="15" style="-fx-padding: 20; -fx-background-color: #1a1a1a; -fx-background-radius: 8;">
                            <children>
                                <Label style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="Código QR de tus Boletas" />
                                
                                <!-- QR Code -->
                                <VBox alignment="CENTER" spacing="10" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 8;">
                                    <children>
                                        <ImageView fx:id="imgQRCode" fitWidth="250" fitHeight="250" preserveRatio="true" />
                                    </children>
                                </VBox>

                                <Label fx:id="lblQRInfo" style="-fx-font-size: 13; -fx-text-fill: #cccccc; -fx-text-alignment: center;" text="Presenta este código QR en la entrada del cine" wrapText="true" maxWidth="500" />

                                <!-- Botón descargar -->
                                <Button fx:id="btnDescargarQR" onAction="#onDescargarQR" 
                                        style="-fx-background-color: #4CAF50; -fx-font-size: 14px; -fx-text-fill: white; -fx-padding: 10 25; -fx-background-radius: 20; -fx-font-weight: bold;" 
                                        text="Descargar QR" />
                            </children>
                        </VBox>

                        <!-- Botones de acción -->
                        <HBox alignment="CENTER" spacing="20" style="-fx-padding: 20 0 0 0;">
                            <children>
                                <Button fx:id="btnVolverInicio" onAction="#onVolverInicio" 
                                        style="-fx-background-color: #8B2E21; -fx-font-size: 15px; -fx-text-fill: white; -fx-padding: 12 35; -fx-background-radius: 25; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, rgba(139,46,33,0.4), 10, 0, 0, 3);" 
                                        text="Volver al Inicio" />
                                
                                <Button fx:id="btnVerHistorial" onAction="#onVerHistorial" 
                                        style="-fx-background-color: #555555; -fx-font-size: 15px; -fx-text-fill: white; -fx-padding: 12 35; -fx-background-radius: 25; -fx-font-weight: bold;" 
                                        text="Ver Historial de Compras" />
                            </children>
                        </HBox>

                    </children>
                </VBox>
            </content>
        </ScrollPane>
    </center>

</BorderPane>
