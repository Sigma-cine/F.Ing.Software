<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<HBox xmlns="http://javafx.com/javafx/21"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="sigmacine.ui.controller.BarraController"
      fx:id="barra"
      alignment="CENTER_LEFT"
      spacing="12"
      styleClass="topbar"
      style="-fx-background-color: #8B2E21; -fx-padding: 10 16 10 16;">

    <children>

        <!-- LOGO -->
        <ImageView
                fx:id="logoImage"
                fitHeight="40.0"
                preserveRatio="true"
                onMouseClicked="#onLogoClick">
            <image>
                <Image url="@/Images/logo.png" />
            </image>
        </ImageView>

        <!-- Botones principales -->
        <Button fx:id="btnCartelera"
                styleClass="toplink"
                text="Cartelera" />

        <Button fx:id="btnConfiteria"
                styleClass="toplink"
                text="Confitería" />

        <Button fx:id="btnSigmaCard"
                styleClass="toplink"
                text="Sigma Card" />

        <Region HBox.hgrow="ALWAYS" />

        <!-- Campo de búsqueda -->
        <StackPane>
            <TextField fx:id="txtBuscar"
                       prefWidth="200"
                       promptText="Buscar"
                       styleClass="search" />
            <Button fx:id="btnBuscar"
                    styleClass="toplink"
                    StackPane.alignment="CENTER_RIGHT">
                <graphic>
                    <ImageView fitWidth="18" fitHeight="18" preserveRatio="true">
                        <image>
                            <Image url="@/Images/search.png" />
                        </image>
                    </ImageView>
                </graphic>
            </Button>
        </StackPane>

        <!-- Carrito -->
        <Button fx:id="btnCart" styleClass="toplink">
            <graphic>
                <ImageView fitWidth="24" fitHeight="24" preserveRatio="true">
                    <image>
                        <Image url="@/Images/cart.png" />
                    </image>
                </ImageView>
            </graphic>
        </Button>

        <!-- Registrarse - SIEMPRE VISIBLE pero opaco con sesión -->
        <Button fx:id="btnRegistrarse"
                styleClass="toplink"
                text="Registrarse" />

        <!-- Iniciar sesión -->
        <Button fx:id="btnIniciarSesion"
                styleClass="toplink"
                text="Iniciar sesión" />

        <!-- MenuButton ÚNICO transparente que incluye ícono + nombre completo del usuario -->
        <MenuButton fx:id="menuUsuario"
                    styleClass="user-menu-btn"
                    visible="false"
                    style="-fx-background-color: transparent; -fx-padding: 8 12 8 8;">
            <graphic>
                <HBox alignment="CENTER_LEFT" spacing="8">
                    <ImageView fitWidth="20" fitHeight="20" preserveRatio="true">
                        <image>
                            <Image url="@/Images/user.png" />
                        </image>
                    </ImageView>
                    <Label fx:id="lblNombreUsuario" 
                           style="-fx-text-fill: white; -fx-font-size: 14px;"
                           text="Usuario" />
                </HBox>
            </graphic>
            <items>
                <MenuItem fx:id="miMisBoletas" text="Mis Boletas" />
                <MenuItem fx:id="miHistorial" text="Historial de compras" />
                <SeparatorMenuItem />
                <MenuItem fx:id="miCerrarSesion" text="Cerrar Sesión" />
            </items>
        </MenuButton>

    </children>
</HBox>